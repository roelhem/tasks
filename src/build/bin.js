import * as yargs from 'yargs'

// Get the commands from the __command_input package, which is dynamically generated by webpack.
let commands = require('__command_input');

// Ensure that commands is an array.
if(!Array.isArray(commands)) {
    if('default' in commands) {
        commands = [commands.default]
    } else if(Object.entries(commands).length > 0) {
        commands = [commands]
    } else {
        commands = []
    }
}

// Loop through each command.
for (const command of commands) {
    // Check if command is an instance of Command
    yargs.command(command)
}

// Parse the arguments if they haven't been already or if there were some commands returned.
if(!yargs.parsed || commands.length > 0) {
    yargs.parse();
}
